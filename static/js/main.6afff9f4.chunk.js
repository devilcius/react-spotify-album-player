(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{13:function(e,t,a){e.exports=a(27)},26:function(e,t,a){},27:function(e,t,a){"use strict";a.r(t);var s=a(0),r=a.n(s),i=a(3),n=a.n(i),o=a(6),l=a(7),u=a(9),c=a(8),p=a(10),m=a(12),h=a.n(m),d=a(5),f=a(4),y=a(2),g=a.n(y),b=a(1),k=a.n(b),v=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},N=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}(),T=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},E=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t},C=function(e){function t(e){v(this,t);var a=E(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={isPlaying:!1},a.audio=new Audio,a.getDuration=a.getDuration.bind(a),a.playTrack=a.playTrack.bind(a),a}return T(t,e),N(t,[{key:"getDuration",value:function(e){var t=e/1e3/60<<0,a=e/1e3%60;return Math.round(t,-2)+":"+(Math.round(a,-2)<10?"0"+Math.round(a,-2):Math.round(a,-2))}},{key:"componentDidMount",value:function(){this.audio.setAttribute("src",this.props.track.preview_url),this.audio.load()}},{key:"componentWillUpdate",value:function(e){e.track.preview_url!==this.props.track.preview_url&&(this.audio.setAttribute("src",e.track.preview_url),this.audio.load())}},{key:"playTrack",value:function(e){e.preventDefault(),this.audio.paused?this.setState({isPlaying:!0},function(){this.audio.play(),this.props.onPlayingStatusChange(!0,this.audio,this.props.track),this.audio.addEventListener("ended",function(){this.setState({isPlaying:!1}),this.props.onPlayingStatusChange(!1,this.audio,this.props.track)})}):(this.audio.pause(),this.setState({isPlaying:!1},function(){this.props.onPlayingStatusChange(!1,this.audio,this.props.track)}))}},{key:"render",value:function(){var e=this.state.isPlaying?"fa fa-pause":"fa fa-play";return g.a.createElement("li",{className:this.props.listGroupItemClassName,onClick:this.playTrack},g.a.createElement("a",{href:"#",className:this.props.listGroupItemLink,style:{cursor:"default"},title:this.props.tooltip},this.props.track.track_number,". ",this.props.track.name," (",this.getDuration(this.props.track.duration_ms),")"),g.a.createElement("span",{className:this.props.listGroupItemBadgeClassName},g.a.createElement("i",{className:e})))}}]),t}(g.a.Component);C.propTypes={listGroupItemBadgeClassName:k.a.string,listGroupItemClassName:k.a.string,listGroupItemLink:k.a.string,onPlayingStatusChange:k.a.func,tooltip:k.a.string.isRequired,track:k.a.object.isRequired},C.defaultProps={onPlayingStatusChange:void 0};var w=function(e){function t(e){v(this,t);var a=E(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.trackChangedStatus=a.trackChangedStatus.bind(a),a}return T(t,e),N(t,[{key:"trackChangedStatus",value:function(e,t,a){this.props.updateTrackPlayingStatus(e,t,a)}},{key:"render",value:function(){var e=this.props.tracks.map(function(e,t){return g.a.createElement(C,{key:t,listGroupItemBadgeClassName:this.props.listGroupItemBadgeClassName,listGroupItemClassName:this.props.listGroupItemClassName,listGroupItemLink:this.props.listGroupItemLink,onPlayingStatusChange:this.trackChangedStatus,tooltip:this.props.previewWarningText,track:e})}.bind(this));return g.a.createElement("ul",{className:this.props.listGroupClassName},e)}}]),t}(g.a.Component);w.propTypes={listGroupItemBadgeClassName:k.a.string,listGroupClassName:k.a.string,listGroupItemClassName:k.a.string,listGroupItemLink:k.a.string,previewWarningText:k.a.string,tracks:k.a.array,updateTrackPlayingStatus:k.a.func},w.defaultProps={tracks:[],updateTrackPlayingStatus:void 0};var P=function(e){function t(e){v(this,t);var a=E(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={albumData:null,playerPlaceholder:'<i class="fa fa-spinner fa-spin"></i>',albumName:a.props.albumName,artistName:a.props.artistName},a.fetchAlbumData=a.fetchAlbumData.bind(a),a.fetchTracks=a.fetchTracks.bind(a),a.firePlayingStatusChangeEvent=a.firePlayingStatusChangeEvent.bind(a),a}return T(t,e),N(t,[{key:"fetchAlbumData",value:function(){var e=new XMLHttpRequest,t=this,a="?q=album:"+this.state.albumName+" artist:"+this.state.artistName;a+="&type=album",e.open("get","https://api.spotify.com/v1/search"+a),e.setRequestHeader("Authorization","Bearer "+this.props.token),e.onreadystatechange=function(){if(4===e.readyState)if(200===e.status){var a=JSON.parse(e.responseText);a.albums.items.length>0?t.fetchTracks(a.albums.items[0].id,function(e){e.tracks.items.length>0?t.setState({albumData:e}):t.setState({albumData:null,playerPlaceholder:t.props.noDataFoundText})}):t.setState({albumData:null,playerPlaceholder:t.props.noDataFoundText})}else t.setState({albumData:null,playerPlaceholder:t.props.noDataFoundText})},e.send()}},{key:"fetchTracks",value:function(e,t){var a=new XMLHttpRequest,s=this;a.open("get","https://api.spotify.com/v1/albums/"+e),a.setRequestHeader("Authorization","Bearer "+this.props.token),a.onreadystatechange=function(){if(4===a.readyState)if(200===a.status){var e=JSON.parse(a.responseText);t(e)}else s.setState({albumData:null,playerPlaceholder:s.props.noDataFoundText})},a.send()}},{key:"firePlayingStatusChangeEvent",value:function(e,t,a){e&&this.props.onTrackPlayed?this.props.onTrackPlayed(t,a):!e&&this.props.onTrackPaused&&this.props.onTrackPaused(t,a)}},{key:"componentDidMount",value:function(){null!==this.props.token?this.fetchAlbumData():console.error("A valid access token is needed to access spotify API")}},{key:"componentWillUpdate",value:function(e){e.albumName===this.props.albumName&&e.artistName===this.props.artistName||this.setState({artistName:e.artistName,albumName:e.albumName},this.fetchAlbumData)}},{key:"render",value:function(){var e=function(){return this.props.showHeader?g.a.createElement("div",{className:"media"},g.a.createElement("div",{className:"media-left"},g.a.createElement("a",{href:this.state.albumData.external_urls.spotify},g.a.createElement("img",{alt:"cover image",className:"media-object",height:"64",src:this.state.albumData.images[0].url,width:"64"}))),g.a.createElement("div",{className:"media-body"},g.a.createElement("h4",{className:"media-heading"},this.state.albumData.name),this.state.albumData.release_date)):null}.bind(this);return null===this.state.albumData?g.a.createElement("section",{className:"spotify-player"},g.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.state.playerPlaceholder}})):g.a.createElement("section",{className:"spotify-player"},e(),g.a.createElement(w,{listGroupClassName:this.props.listGroupClassName,listGroupItemBadgeClassName:this.props.listGroupItemBadgeClassName,listGroupItemClassName:this.props.listGroupItemClassName,listGroupItemLink:this.props.listGroupItemLink,previewWarningText:this.props.previewWarningText,tracks:this.state.albumData.tracks.items,updateTrackPlayingStatus:this.firePlayingStatusChangeEvent}))}}]),t}(g.a.Component);P.propTypes={albumName:k.a.string.isRequired,artistName:k.a.string.isRequired,listGroupClassName:k.a.string,listGroupItemBadgeClassName:k.a.string,listGroupItemClassName:k.a.string,listGroupItemLink:k.a.string,noDataFoundText:k.a.string,onTrackPaused:k.a.func,onTrackPlayed:k.a.func,previewWarningText:k.a.string,showHeader:k.a.bool,token:k.a.string},P.defaultProps={listGroupClassName:"list-group",listGroupItemBadgeClassName:"badge",listGroupItemClassName:"list-grouprequired to work-item",listGroupItemLink:"",noDataFoundText:"No data found",onTrackPaused:void 0,onTrackPlayed:void 0,previewWarningText:"Only 30 seconds preview",showHeader:!0,token:null};var S=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(c.a)(t).call(this,e))).clientId="0454e14b019d4236b4cf5fd4fd9525ee",a.scopes="user-top-read",a.redirectUri="https://devilcius.github.io/react-spotify-album-player/",a.login=a.login.bind(Object(f.a)(a)),a.updateRecord=a.updateRecord.bind(Object(f.a)(a)),a.state={albumName:"Milo Goes to College",artistName:"Descendents",spotifyToken:null,spotifyUri:null,spotifyUser:null},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=window.location.hash.substr(1).split("&")[0].split("=")[1];e&&window.opener.spotifyCallback(e)}},{key:"login",value:function(){var e=this,t=window.open("https://accounts.spotify.com/authorize?client_id=".concat(this.clientId,"&response_type=token&redirect_uri=").concat(this.redirectUri,"&scope=").concat(this.scopes,"&show_dialog=true"),"Login with Spotify","width=800,height=600");window.spotifyCallback=function(a){t.close(),fetch("https://api.spotify.com/v1/me",{headers:{Authorization:"Bearer ".concat(a)}}).then(function(e){return e.json()}).then(function(t){e.setState({spotifyToken:a,spotifyUser:t})})}}},{key:"updateRecord",value:function(e){e.preventDefault();var t=n.a.findDOMNode(this.refs.artist).value,a=n.a.findDOMNode(this.refs.release).value;this.setState({artistName:t,albumName:a})}},{key:"setTrackInfo",value:function(e,t){this.setState({spotifyUri:t.uri})}},{key:"clearTrackInfo",value:function(){this.setState({spotifyUri:null})}},{key:"render",value:function(){return r.a.createElement("div",null,null!==this.state.spotifyToken&&r.a.createElement("div",{className:"demo-container"},r.a.createElement("p",null,"Click on a song to preview it"),r.a.createElement(P,{albumName:this.state.albumName,artistName:this.state.artistName,listGroupClassName:"pure-menu-list",listGroupItemClassName:"pure-menu-item",listGroupItemLink:"pure-menu-link",noDataFoundText:"No data found",onTrackPaused:this.clearTrackInfo.bind(this),onTrackPlayed:this.setTrackInfo.bind(this),previewWarningText:"Only 30 seconds preview",showHeader:!0,token:this.state.spotifyToken}),r.a.createElement("div",{className:"form-container"},r.a.createElement("form",{className:"pure-form",onSubmit:this.updateRecord},r.a.createElement("fieldset",null,r.a.createElement("legend",null,"Find another album"),r.a.createElement("input",{placeholder:"artist name",ref:"artist",required:!0,type:"text"}),r.a.createElement("input",{placeholder:"release name",ref:"release",required:!0,type:"text"}),r.a.createElement("button",{className:"pure-button"},"Search"))),r.a.createElement("div",{className:"extra-info"},r.a.createElement("hr",null),r.a.createElement("h5",null,"On playing event:"),"Spotify URI: ",r.a.createElement("strong",null,this.state.spotifyUri)))),null===this.state.spotifyToken&&r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement("strong",null,"You must authorize this app")),r.a.createElement("button",{className:"pure-button",onClick:this.login},"authorize")))}}]),t}(r.a.Component);a(23),a(24),a(25);var I=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"pure-g"},r.a.createElement("header",{className:"pure-u-1"},r.a.createElement("h1",null,d.name),r.a.createElement("div",{className:"description"},d.description)),r.a.createElement(h.a,{className:"right",project:d.user+"/"+d.name}),r.a.createElement("article",{className:"pure-u-1"},r.a.createElement("h2",null,"Demonstration"),r.a.createElement(S,null)))}}]),t}(r.a.Component);a(26);n.a.render(r.a.createElement(I,null),document.getElementById("root"))},5:function(e){e.exports={name:"react-spotify-album-player",homepage:"https://devilcius.github.io/react-spotify-album-player",description:"Spotify player for a specific artist's album",user:"devilcius",version:"0.0.0",license:"MIT",private:!0,dependencies:{"highlight.js":"^9.15.6","prop-types":"^15.6.2",purecss:"^1.0.0",react:"^16.4.1","react-dom":"^16.4.1","react-ghfork":"^0.5.1","react-scripts":"^2.1.8","react-spotify-album-player":"link:.."},scripts:{start:"react-scripts start",build:"react-scripts build",test:"react-scripts test --env=jsdom",eject:"react-scripts eject"},browserslist:[">0.2%","not dead","not ie <= 11","not op_mini all"]}}},[[13,1,2]]]);
//# sourceMappingURL=main.6afff9f4.chunk.js.map